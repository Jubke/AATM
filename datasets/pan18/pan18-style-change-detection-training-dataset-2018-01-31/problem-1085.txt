It is irrelevant here if the ball does not go where the defender intended - all that matters when determining whether the defender's contact with the ball is a deflection or deliberately played is whether they attempted to play it or not. If the ball merely deflected off the defender (as is implied by your question and the use of the word ricocheted), an offside offence has been committed. The attacker is penalised for gaining an advantage by being in that position by playing a deflection off an opponent. On occasions when the whole of the ball does not cross the goal line and play continues as normal because a goal has not been scored, the referee must make eye contact with the assistant referee and if necessary give a discreet hand signal. 

The players other than the kicker and goalkeeper must be: 

However, it is a general understanding amongst referees (think of it as common law) that players should not be cautioned for persistent infringement when the infringement only harms their team eg. taking a free kick to oneself, incorrectly taking a throw-in, offside. This forum thread on RefChat highlights this: 

p. 21 of the 2015/16 FIFA Laws of the Game: If the defender deliberately tried to play the ball, it needs to be determined whether it was a deliberate save or not. If the ball was heading towards the goal (since it was a shot), it probably was a deliberate save, and there would still be an offside offence. However, if this was a cross or pass not heading towards the goal and the defender deliberately played the ball, there would be no offside offence committed here. While a substitute or substituted player can technically be sent-off for any of the seven sending-off offences a player is subject to, there are only three offences for which they may be cautioned. 

This is a massive change in how offside position is determined for attackers leaving the field of play, with very little explanation. 

The hands and arms of all players, including the goalkeepers, are not considered. 

This is no longer contained in the present text of the Laws, but was last seen in the 2006 FIFA Q&A to the Laws of The Game, p.30: In some elite matches without goal-line technology (such as UEFA competitions), additional assistant referees (who are positioned slightly behind the goal line) will also help the referee make goal/no goal decisions. The relevant information is on p. 85 of the 2015/16 FIFA Laws of the Game: No it's a technical offence, a bit like persistently taking a throw-in incorrectly, which you wouldn't caution for either Actually I don't see how the striker is doing anything wrong beside being offside The principle of awarding a restart from the most advantageous field position (by playing a silent advantage) is enshrined in this piece of unrelated advice on p. 120 of the 2015/16 FIFA Laws of the Game: If this goes further, and playing the ball moves from being unsafe to an impossibility (for an unreasonable amount of time), a player is cautioned for unsporting behaviour. Note that there is no requirement here for opponents to be nearby. 

He stops play, cautions the player for unsporting behaviour and restarts play with an indirect free kick. Thanks to posdef, here is a clip of Cuauht√©moc Blanco using this technique. From page 72 of FIFA's 2013-2014 Laws of The Game: This is a common problem with the 2016/17 Laws of the Game. The entire document was rewritten, and this was rushed through without seeking feedback from the global community of players, managers, referees and other officials for an extensive period, so contradictions occur, or entire sections appear unclear. 

The restart location is no longer a point of contention, as this has been simplified in the 2016/17 Laws: 

This is done to avoid unnecessary collisions between attackers and defenders (particularly the goalkeeper), and large delays in having to bring the ball back to where the attacker was positioned when the ball was played for the free kick when it's completely obvious an offside offence is about to occur. When the ball is in play, the assistant referee will do their best to remain in line with whichever one of 

It is worth mentioning that Law 12 mentions that a player may be cautioned for persistent infringement. 

This is nothing more than a poor tactic. Neither of these players can really do anything of significance until the ball has been deliberately played (other than a deliberate save) by an opponent or goes out of play. Until this happens, they're effectively leaving their team short by two players. If an offside-positioned, attacking player off the field somehow manages to interfere with an opponent (I see this as fairly unlikely), an indirect free kick is awarded on the field of play, closest to where the offence occurred. 

If he does it again, do it again 

This is completely legal, provided it is done in a manner in which it is still possible to safely challenge for the ball or there are no opponents nearby. The restart is once again an indirect free kick. 

FIFA Laws of the Game, 2013/14, p. 121: 

Only a player, substitute or substituted player may be shown the red or yellow card. If there is fumble, or slowly moving ball, this will enable them to see if the ball has crossed the line most of the time. This is highlighted on p. 88 of the 2015/16 FIFA Laws of the Game: The additional assistant referee must communicate to the referee when a goal has been scored. IFAB Laws of the Game, 121.2 Offside Offence: Finally, here's an example of a referee having a penalty kick retaken multiple times for encroachment by both the goalkeeper and outfield players. In my opinion, at the time when this occurred in 2004, he would have been correct. However, by 2017 standards, none of the kicks required referee intervention.