Ah, the heartbreak of parenthood (I'm serious.) You have asked what you can do. You say your son offered a half-hearted apology. If you want him to learn why his behavior hurts others as well as himself, he'll have to do a lot better than half-hearted apologies. 

I want to emphasize that you've got a limited amount of time in which to act here. A child becomes an adult at 18, and there's very little you can do after that to force change of any kind. 

I don't know if you have family therapists there. If you do, it might be a good idea for all of you to talk with one to get the issues out into the open. Are there any studies that don't support the idea that all corporal punishment is abusive? Or that, at any event, not everyone suffers serious consequences from it? I'm not talking about the more familiar "Outward Bound" type programs, or sloppy programs thrown together to make a buck (where there has been teen-abuse and even some deaths); I'm referring to true wilderness therapy programs as discussed in this article from the American Psychological Association webpage discussing the rationale: If you don't, then befriend and talk with older women in your culture who seem to have raised their children to be truly good people, and hear what they have to say. Maybe they can give you some insight into discipline that was both effective and loving. In the meantime, if she is soon to leave, love her as best as you can in this situation, for she did not create it. If her father left her mother for you, accept that she will not love you immediately. But there are standards she should obey, and discipline she should endure for bad behavior that she can't skirt with money. This episode has already been paid for by the slap she received. Forgive her and move on from it. I doubt it will become a habit. 

We were duped. Almost everyone was duped. For more recent studies have shown that when a child is complimented insincerely, or on things they cannot control (how do you stay awesome/smart/gifted/super? By never taking the chance of proving people wrong by trying new things!), but research is now indicating this method has unintended consequences: we actually decrease their confidence in themselves and decrease their willingness to risk and fail. 

There are some very significant things in what you've said: he's in the school's gifted program, is in the 99th%ile on the standardized tests, but he doesn't study or do his homework. He is a good kid, but immature. At the same time he makes excuses or lies about why he gets bad grades every time. 

If there's more (he's at a new school because there was a separation and you moved; he's at a new school because there was a job change and you moved; he's angry at losing his old friends, there are cliques at his new school, he's in a very different kind of school environment in which he feels insecure, etc., etc.) then your job is harder, but whatever the case, you need to start having some regular talks about why before you can effect a change. One evening, he called us to the table. "What's for supper?" asked one of the kids. "Shark," my ex answered. We were all silent. Finally I said, "I'm sorry, but I'm not eating it. You know we don't like shark." The table erupted. "If Mommy isn't eating it, neither am I!" the kids cried. This was treason! 5. Ask if there's anything he can do to mitigate the hurt he's caused. (E.g. if he did this in front of other kids, he should also apologize publicly as well. This is mitigating if the recipient was humiliated.) 

Why is she living with you? Where is her mother? Is she living with you against her will? How is her relationship with her father? Why were her parents divorced? Where does she get money to buy a new phone when hers is confiscated? Children have a full set of the same emotions as adults; they just can't express them as well as adults, and have little to no real power of decision-making in the family. I believe that treating a child unjustly will breed resentment and insecurity, whereas logical, appropriate and proportional consequences give a child guidelines, choices and a sense of security. 

I want to add that we had weekly family meetings where anything could be discussed. This was helpful to us. Some of the behavior you're seeing (talking to boys, not covering her face) are behaviors she picked up in the US. It is hard to go from a place of some freedom to a place of more restrictions when one is that age. She is unfortunately not mature enough to appreciate all that you do for her and the extra work of having her in your house. 

I can't address your daughter's behavior (hopefully others will.) But I believe you may feel things more deeply than is good for both (or all) of you. I would suggest you start in therapy to see why a six-year-old has so much power over you. 

1. Own the offensive behavior (it didn't just happen; he doesn't get to say, "I don't know why I did it..."), which means he has to think it out honestly. You can help him do this.1 

Unfortunately, I believe you picked bad examples to ask about. Children learn about the world by taking chances (what your sister calls exploring.) If he doesn't fall, the child feels more capable and competent, which is good. If he does fall, he learns about adverse consequences, which is also good. (It is unlikely that he will injure himself seriously by falling from something the height of an armrest.) In many cases, your sister is correct. If it's your sister's couch, it's your sister's child, and her call to make. If it's your couch, your wishes to not to have the child walk on the arm rests should be respected. But respect for the wishes of others is not synonymous with obedience. It's based on empathy, something which even 3 year olds are beginning to be able to understand.