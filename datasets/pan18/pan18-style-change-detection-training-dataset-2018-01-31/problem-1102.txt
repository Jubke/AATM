is closest to the goal line (p.86 - FIFA 2014/15 Laws of The Game). 

This streamable shows the importance of not making ball out decisions unless you're entirely sure. In the first two views, with a slight angle and in real time, my guess would be that the ball is out by a number of centimetres. It is not until the clip is slowed down with an angle parallel to the goal line that you can see that part of the ball is still overhanging the goal line and the decision is incorrect. 

If the referee has no help from assistant referees (either by virtue of them not being appointed, or by the fact they are too far from the goal line to offer advice), and the referee cannot decide that the ball has crossed the goal line, the decision is then that the ball has not crossed the line and play continues. This decision is indisputable, as highlighted on p. 26 of the 2015/16 FIFA Laws of the Game: 

If the shirt pulling denies an obvious goalscoring opportunity, the player is sent-off, no matter where the offence occurs. 

If multiple players are committing dissent, the restart is taken from the position of whichever one is closest to their own goal line (this could even be the opposing goalkeeper, which would see the ball moved ninety metres down the other end of the field). 

However, applying 2017 standards, I believe that only the blatant goalkeeper infringement on the second kick should have been retaken. In 2017, this would also require the goalkeeper to be cautioned, but this seems proportionate, given that he was one to one-and-a-half metres off his line before the kick was taken. 

Contrary to other answers (which since have been deleted), neither the direction that the ball is played nor where the player is standing when he touches the ball have any relevance on whether an offside offence has occurred. 

As seen there are two elements to this offence, the first is: