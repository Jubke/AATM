As it was told too many times (day9 in its shows, on SE, etc): you skills are determining your APM (not your APM will determine your skills). Lets assume you are doing 4 gate push. In this case the most important thing to get you army under opponent door AS EARLY AS POSSIBLE!!! That means: 

Answer is simple and hard: ASAP (if you play MMM, as you mentioned) or never (if you play Mech). 

In game against Protoss: if they have DT/Colossus/templars - armor upgrade doesn't help too - so do attack first. If they have zealot/stalkers/sentries - armor as important as attack. But still I would start from attack upgrade as marines under stim pack are very good for kiting. 

In game against Terran: if you see StartPort with techlab - that means banshees probably with cloak. Then you need: 1) expand, 2) EB + turrets in mineral lines. If you see opponent plays MM/MMM too: do infantry upgrades ASAP, if he goes mech play - think how to counter and if you will go with infantry - do upgrades ASAP. If no - delay them. 5 - for Barracks/GateWays - 1st tier unit buildings, for Zerg - Hatcheries 6 - for Factory/Robotics Facility - 2nd/3rd tier ground units; 7 - for StarPort/StarGate - air units; I did the above and finished sometime around 4:30. 

After priority changing Thor will attack infantry himself. But if you want him to shoot down the medivacs - you will need to give him only few orders, usually medivacs quantity is much less then marines :) 

I would suggest another way: if you plan MMM play - build in parallel 2 Engineering Bays, once both upgrades are started - build armory. You need both of these upgrades picked up to level 3 ASAP. EDIT: good way against Medivacs is Ghost's EMP - it will remove their energy and you can don't hunt them at all (at least right now). In game against Zerg: usually, around 8-9 minutes Zerg build mutas. For sure, you need to scout that. Too often you don't have any chance to build engineer bay till this time. But around that time, once spire is scouted - build 2 EB right immediately and build 2 turrets in each mineral line... and start both upgrades. In game against Terran: if you opponent play mech: tanks, Thors... armor doesn't help too. so again - start from attack upgrade. If they play MMM - armor and attack same in importance. Can a ghost throw an EMP while sitting inside a bunker? In game against Protoss: depends from opponent. If he going to some kind of gateway units/Immortals - upgrade you infantry asap. If he goes for Colossus - you could delay infantry a little to get some Vikings/Thors and concentrate on their upgrades in first turn. As I replied to comment, it is worth to build 2 EB, save some gas in order to get both upgrades, but if (due to some reasons) planning to do 1 upgrade only and you detected mutas (and/or mass mutas) it could be worth to start with defense upgrade. Having +1 defense upgrade reduce mutas damage from 13 (9+3+1) to 10 (8+2+0) => +23.1%, but having +1 attack upgrade increase your rines attack from 5 to 6 => 16.7% 

Though, that's true: with higher APM you will be able to handle your forces more accurate. But more important is to be on opponent base on 6 minute with 2 zealots + 4stalker (for example) while he has 1 zealot and 2 stalkers yet... 

Liberation Day - 2:23 The Outlaws - 3:41 Zero Hour - 20:09 Smash and Grab - 6:25 Devil's Playground - 9:58 Welcome to the Jungle - 9:45 Great Train Robbery - 24:19 Cutthroat - 10:02 Engine of Destruction - 22:05 Media Blitz - 14:51. The Dig - 28:14 Moebius Factor - 8:46 The Evacuation - 24:56 Outbreak - 20:34 Supernova - 13:20 Maw of the Void - 13:47 Gates of Hell - 12:22 Shatter the Sky - 14:46 All-In - 30:08