Q: Also, are there any phonemes that (are so marked that they) are not acquired at all by a substantial part of the population (say more than 5 %)? Before you start writing your own program you might also want to consider using or adapting existing solutions. There are some tools that use phonemic forced alignment, such as HTK. Together with an acoustic model of the language you are working on and an orthographic transcription of the text, this produces a phonemic time-aligned transcription of an audio recording. Together with P2FA, which provides a wrapper and an acoustic model of American English, and outputs Praat TextGrids, I have achieved good results even for other varieties of English. You could also take a look at MAUS, which provides a web interface for a small number of languages and also produces Praat TextGrids. 

I have found literature on marked phonemes in a rage of languages, but not much on the age of acquisition of marked phonemes in different languages. Also, I have heard that the trilled /r/ present in Spanish and other languages is acquired very late and that some teachers think children often need help to properly acquire this sound - but this seemed rather unlikely to me if only for the reason that trilled /r/ appears to occur in a good number of languages and claims that children need "help" in acquiring their first language sound more like a difference between dialect and standard and teachers' desire to make their students use standard language. 

The maximum onset principle (MOP) Q: Are there marked or "hard" phonemes that are acquired even later in First Language Acquisition? Please support your answers with scholarly references. 

Often I find colour easier to interpret: 

In fact, the eminent phonetician John Wells argues in his blog that it already has been (thanks to @Sumelic for the link). His case in point is the pair century - sentry. Q: Can anybody suggest free software that produces online colour gradient spectrograms? As such, the phenomenon is one of co-articulation and not a phonological process. So an onset /t͡ʃɹ/ (which might be spelled chr if it weren't for the confusion with /kɹ/ as in Christmas) is still illegal in English phonotactics. However, over time this co-articulatory process may become so common that it is phonologised and the contrast is neutralised. 

Here are two references you might find useful: (2) More importantly, I couched my question in terms of markedness because I think it's a relatively uncontroversial concept, but it's really not central to my question. I'm asking whether there are phonemes that are acquired very late or never by a substantial number of speakers, whether you want to call them marked or articulatorily complex or challenging or hard. Answers should if possible be empirically sound such as quantitative claims from surveys, personal experience from teaching, child-rearing etc., with references where appropriate. 

Caveat: in some American intro linguistics textbooks, a segment is incorrectly defined as a speech sound (phone) only. 

Upward and Davidson argue that by the 14th century "spellings with QU had become the norm" (p. 149). For more details, see http://www.historyofenglishspelling.info/ Phonetics isn't my forte, so I don't follow literature on phonetics and I might be wrong. Here's my guess. An affricate is a stop followed by a fricative, homo- or heterorganic (same or different place of articulation). The tip of the tongue is retracted (moved back) for "t/d" in anticipation of the following "r". In fact, O'Connor 1994 argues that it is on the front of the hard palate. See below what he says: In The Linguistic atlas of England, you can find excellent maps; see, for example, the word "oak" (or loaf, toad etc.), which is not diphthongized in some dialects. In British English, things are way more complicated. Although [əʊ] is the most common variant now, there are other variants, too; see part 8.10.4 in Gimson's Pronunciation of English (7th ed.). 

Thus, a segment is "any element, at any level of representation, which is described as forming sequences with others" (Matthews 2007).