For example, the French Lebel and ubiquitous German Gewehr 98 (aka "the Mauser") were 1.3 meters long! These were later cut down into carbine versions like the Karabiner 98k, but still very long at 1.1 meters. The US WWII M1 Garand service rifle was also 1.1 meters. Even a modern M16 rifle is 1 meter long. 

Repeating Weapon Finally, in the era of single shot muzzle loaders a melee weapon would be used simply because you couldn't reload your gun fast enough in the chaos of close quarter combat. This could be a bayonet, a sword, or even swinging your rifle like a club as in this popular (and probably not terribly accurate) painting of Davy Crockett in the Battle of the Alamo. 

You fired your one shot, then switched to melee rather than try to take the 10 to 15 seconds to load with the enemy right in front of you. Even later breech loading weapons such as revolvers, tube magazine fed repeaters, and stripper clips were slow and awkward to reload in close combat. It wasn't until disposable, detachable box magazines became standard at the end of WWII that reloading in close quarters became really viable. 

A long weapon made even longer with a bayonet limits how you can go around corners, through doors, or turn around. The long "shaft" of the rifle can be easily side-stepped and grabbed by your opponent turning it into a liability. In these cases a pistol or dedicated close-quarters rifle is much preferred, but many soldiers lack these. So they pack a short, brutal, often improvised melee weapon. 

Ammunition Obviously if you run out of ammunition your ranged weapon is nothing but an awkward club. A smart commander who is running low on ammunition will hold their fire to conserve their limited ammunition for the most critical moments. Rather than firing on, say, a lone soldier, they will wait until there's a large group of troops. Or hold their ammunition in reserve until there's an enemy breakthrough. 

Finally, the rear ranks of 1 and 2 can sidestep to extend the line and close the gap. 

Modern armies are switching to even shorter weapons like the M4 carbine at 0.84 meters as their service rifle to ensure every soldier has a rifle that works in as many situations as possible. 

Archery is a skill which degrades if not practiced, both mentally and physically. Archery requires a lot of strength to draw the bow and hold it steady to aim, on the order of 100 pounds of pull. It is physically demanding to simply do it once, much less 60 times over the course of a battle.